function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,i,o){return i&&t(e.prototype,i),o&&t(e,o),e}}(),XIVDBTooltipsClass=function(){function t(e){_classCallCheck(this,t),this.version="0.7",this.options=e,this.hasInitialized=!1,window.location.href.indexOf(this.xivdb)>-1&&(this.options.includeCredits=!1)}return _createClass(t,[{key:"initialize",value:function(){var t=this;XIVDBTooltipsDevice.setOptions({mobileIgnore:this.options.mobileIgnore,mobileWidth:this.options.mobileWidth}),XIVDBTooltipsDevice.isOnMobile()||(this.validateTooltipOptions(),XIVDBTooltipsDependency.passed(function(){XIVDBTooltipsDevice.handleResponsive(),XIVDBTooltipsDOM.prepare(),t.hasInitialized=!0,t.get()}))}},{key:"getVersion",value:function(){return this.version}},{key:"getOption",value:function(t){return this.options[t]}},{key:"validateTooltipOptions",value:function(){for(var t in xivdb_tooltips_default)"undefined"==typeof this.options[t]&&(this.options[t]=xivdb_tooltips_default[t])}},{key:"get",value:function(){this.hasInitialized&&!XIVDBTooltipsDevice.isOnMobile()&&(XIVDBTooltipsUrls.parse(),(links=XIVDBTooltipsUrls.getLinks())&&XIVDBTooltipsQuery.get(links,function(t){XIVDBTooltipsDOM.inject(t),(CompletedEvent=XIVDBTooltips.getOption("event_tooltipsLoaded"))&&CompletedEvent()}))}},{key:"hide",value:function(){XIVDBTooltipsDOM.hide()}}]),t}(),XIVDBTooltipsDependencyClass=function(){function t(){_classCallCheck(this,t),this.jquery="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js",this.fa="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css"}return _createClass(t,[{key:"passed",value:function(t){var e=this;return this.checkForJquery(),"undefined"==typeof $?setTimeout(function(){return"undefined"==typeof $?console.error("jquery could not be embedded, tooltips cannot run"):(e.checkForFontAwesome(),t())},500):t()}},{key:"checkForJquery",value:function(){if("undefined"==typeof $||!window.jQuery){var t=document.createElement("script");return t.type="text/javascript",t.src=this.jquery,document.getElementsByTagName("head")[0].appendChild(t),!0}return $?!0:!1}},{key:"checkForFontAwesome",value:function(){if(0==$('link[href="'+this.fa+'"]').length){var t=document.createElement("link");t.setAttribute("href",this.fa),t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),$("head")[0].appendChild(t)}}}]),t}(),XIVDBTooltipsDeviceClass=function(){function t(){_classCallCheck(this,t),this.onMobile=!1,this.mobileIgnore=xivdb_tooltips_default.mobileIgnore,this.mobileWidth=xivdb_tooltips_default.mobileWidth}return _createClass(t,[{key:"isOnMobile",value:function(){return this.onMobile}},{key:"setOptions",value:function(t){this.mobileIgnore=t.mobileIgnore,this.mobileWidth=t.mobileWidth}},{key:"handleResponsive",value:function(){var t=this;this.mobileIgnore||(this.onMobile=Math.max(document.documentElement.clientWidth,window.innerWidth||0)<=this.mobileWidth?!0:!1,$(window).resize(function(){t.onMobile=Math.max(document.documentElement.clientWidth,window.innerWidth||0)<=t.mobileWidth?!0:!1}))}}]),t}(),XIVDBTooltipsDOMClass=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"prepare",value:function(){var t=this,e=XIVDBTooltips.getOption("xivdb"),i=XIVDBTooltips.getVersion();$("head").append('<link href="'+e+"/tooltips.css?v="+i+'" rel="stylesheet" type="text/css">'),$("body").append('<div class="xivdb" style="display:none;"></div>'),$("body").on("mouseenter","[data-xivdb-tooltip]",function(e){var i=$(e.currentTarget),o=i.attr("data-xivdb-tooltip");$(".xivdb").html(o),t.show(e),i.unbind("mousemove").mousemove(function(e){t.follow(e)})}).on("mouseleave","*[data-xivdb-tooltip]",function(e){var i=$(e.target);i.unbind("mousemove"),t.hide()}),XIVDBTooltips.getOption("preventHtmlHeight")||$("html").css({height:"100%"})}},{key:"hide",value:function(){$(".xivdb").hide().html("")}},{key:"show",value:function(t){this.follow(t),$(".xivdb").show()}},{key:"follow",value:function(t){var e=XIVDBTooltips.getOption("linkContainer"),i=t.pageX+12,o=t.pageY+12,n=$(".xivdb").outerWidth(!0),s=$(".xivdb").outerHeight(!0),l=o+s,a=i+n,r=$(e).height()+$(e).scrollTop(),d=$(e).scrollLeft()+$(e).width();a>d&&(i=t.pageX-n),l>r&&(o=t.pageY-s),this.position(i,o)}},{key:"position",value:function(t,e){$(".xivdb").css({top:e+"px",left:t+"px"})}},{key:"inject",value:function(t){for(var e in t)for(var i in t[e]){var o=t[e][i],n=o.data,s=o.html,l="xivdb_"+e+"_"+n.id,a=XIVDBTooltips.getOption("linkContainer"),r=this.getFrame(),d=$(a+' [data-xivdb-key="'+l+'"]:visible');if(d&&0!=d.length&&!(d.attr("data-xivdb-tooltip")&&d.attr("data-xivdb-tooltip").length>0)){if(r.find(".xivdb-fc").html(s),XIVDBTooltips.getOption("includeCredits")&&r.find(".xivdb-fc").append('<div class="xivdb-copyright">xivdb.com</div>'),XIVDBTooltips.getOption("includeFrameShadow")||r.find(".xivdb-frame-shadow").removeClass("xivdb-frame-shadow"),d.attr("data-xivdb-tooltip",r.html()),this.checkLinkSettings(d,["seturlname","replacename"])&&d.text(n.name),this.checkLinkSettings(d,["seturlcolor","colorname"])){var c=XIVDBTooltips.getOption("seturlcolorDarken")?"rarity-"+n.color+"-darken":"rarity-"+n.color;d.addClass(c)}if(this.checkLinkSettings(d,["seturlicon","showicon"])){var c="xivdb-ii",p=XIVDBTooltips.getOption("iconSize");XIVDBTooltips.getOption("iconCircle")&&(c+=" xivdb-iir"),d.prepend('<img src="'+n.icon+'" class="'+c+'" height="'+p+'">')}}}}},{key:"checkLinkSettings",value:function(t,e){for(var i in e){var o=e[i],n="data-xivdb-"+o;if(XIVDBTooltips.getOption(o)===!1)return!1;if(t.attr(n)&&("0"==t.attr(n)||"false"==t.attr(n).toLowerCase()))return!1}return!0}},{key:"getFrame",value:function(){return $("<div></div>").html('<table class="xivdb-frame xivdb-frame-shadow" width="0" border="0" cellspacing="0" cellpadding="0"><tr><td class="xivdb-fw xivdb-ftl"></td><td class="xivdb-fh xivdb-ft"></td><td class="xivdb-fw xivdb-ftr"></td></tr><tr><td class="xivdb-fw xivdb-fml"></td><td class="xivdb-fc" valign="top"></td><td class="xivdb-fw xivdb-fmr"></td></tr><tr><td class="xivdb-fw xivdb-fbl"></td><td class="xivdb-fh xivdb-fb"></td><td class="xivdb-fw xivdb-fbr"></td></tr></table>')}}]),t}(),XIVDBTooltipsUrlsClass=function(){function t(){_classCallCheck(this,t),this.links={}}return _createClass(t,[{key:"getLinks",value:function(){return this.links.length>0?this.links:!1}},{key:"parse",value:function(){this.links={},$(XIVDBTooltips.getOption("linkContainer")+" a").each(function(t,e){var i=$(e),o=i.attr("href");if(!i.attr("data-xivdb-ignore")&&!i.attr("data-xivdb-tooltip")&&!("undefined"==typeof o||o.length<1)&&(XIVDBTooltips.getOption("includeHiddenLinks")||i.is(":visible"))&&(o=o.toString().toLowerCase().replace("//","/").replace("http:","").replace("https:","").toString(),("/"==o[0]||-1!=o.indexOf(XIVDBTooltips.getOption("xivdb")))&&(o=o.replace("xivdb.com",""),o=o.split("/").filter(function(t){return t.toString().length>0}),-1!=xivdb_tooltips_valid_types.indexOf(o[0])))){var n=o[0].replace("?",""),s=o[1],l="xivdb_"+n+"_"+s;if(!("undefined"==typeof o||o.length<2))return o.indexOf("xivdb.com/?")>-1&&(o=o.replace("xivdb.com/?","xivdb.com/"),i.attr("href",o.toString())),i.attr("data-xivdb-parent")&&!i.attr("data-xivdb-key")?i.parents(i.attr("data-xivdb-parent")).attr("data-xivdb-key",l):i.attr("data-xivdb-parent")?void 0:i.attr("data-xivdb-key",l)}}),this.links=XIVDBTooltips.getOption("includeHiddenLinks")?$(XIVDBTooltips.getOption("linkContainer")+" [data-xivdb-key]"):$(XIVDBTooltips.getOption("linkContainer")+" [data-xivdb-key]:visible")}}]),t}(),XIVDBTooltipsQueryClass=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"get",value:function(t,e){if(!XIVDBTooltipsDevice.isOnMobile()){var i={};t.each(function(t,e){var o=$(e).attr("data-xivdb-key").split("_"),n=o[1].toString(),s=parseInt(o[2]);0!=n.length&&s&&("undefined"==typeof i[n]&&(i[n]=[]),i[n].push(s))});for(var o in i)i[o]=i[o].join(",");this.query(i,e)}}},{key:"query",value:function(t,e){XIVDBTooltipsDevice.isOnMobile()||$.ajax({url:XIVDBTooltips.getOption("xivdb")+"/tooltip",method:"POST",dataType:"json",cache:!0,data:{list:t,language:XIVDBTooltips.getOption("language")},success:function(t){return t?"object"!=typeof t?void console.error("Tooltips response was not an object"):void(e&&e(t)):void console.error("Tooltips returned no response")},error:function(t,e,i){console.error("----------------"),console.error("Error loading tooltips!"),console.error(t.responseText),console.error(e,i),console.error("----------------")}})}}]),t}(),xivdb_tooltips_default={xivdb:"http://xivdb.com",language:"en",jqueryEmbed:!0,fontAwsomeEmbed:!0,seturlname:!0,seturlcolor:!0,seturlcolorDarken:!0,seturlicon:!0,iconSize:20,iconCircle:!0,tooltipFixed:!1,tooltipFixedBottom:!1,targetBlank:!0,includeHiddenLinks:!0,includeCredits:!0,includeFrameShadow:!1,includeLocalLinks:!1,preventHtmlHeight:!1,container:window,linkContainer:"body",parentTooltipAttribute:"data-xivdb",parentTooltip:!0,watch:".search-content",watchDelay:750,mobileIgnore:!1,mobileWidth:720,event_tooltipsLoaded:null},xivdb_tooltips_valid_types=["item","achievement","action","gathering","instance","leve","enemy","emote","placename","status","title","recipe","quest","shop","npc","minion","mount","weather","fate"],XIVDBTooltips=new XIVDBTooltipsClass("undefined"!=typeof xivdb_tooltips?xivdb_tooltips:xivdb_tooltips_default),XIVDBTooltipsDevice=new XIVDBTooltipsDeviceClass,XIVDBTooltipsUrls=new XIVDBTooltipsUrlsClass,XIVDBTooltipsQuery=new XIVDBTooltipsQueryClass,XIVDBTooltipsDependency=new XIVDBTooltipsDependencyClass,XIVDBTooltipsDOM=new XIVDBTooltipsDOMClass;document.addEventListener("DOMContentLoaded",function(t){XIVDBTooltips.initialize()});